# Price Watcher Service

Сервіс для відстеження зміни ціни оголошень на **OLX**.

## Опис

Цей сервіс дозволяє користувачам підписатися на зміну ціни конкретного оголошення на OLX. Після підписки сервіс перевіряє ціну оголошення і надсилає повідомлення на email користувача, якщо ціна змінилася та якщо користувач веріфікував пошту.

Сервіс оптимізований під велику кількість користувачів а також самих оголошень по засобу Batch job.

## Основний функціонал

- **Підписка на зміну ціни:** через HTTP API користувач передає URL оголошення та email.
- **Верифікація email:** підтвердження поштової адреси перед активацією підписки.
- **Можливість відправки додаткового email:** сервіс також може надіслати окреме повідомлення на пошту користувача для підтвердження email, якщо попереднє повідомлення не надійшло.
- **Відстеження змін ціни:** сервіс отримує актуальну ціну оголошення за допомогою запуску job через шедулер з періодичністю, вказаною в конфігурації.
- **Надсилання повідомлень:** email повідомлення надсилаються лише підтвердженим користувачам при зміні ціни.
- **Налаштування стратегії трекінгу ціни:** можна змінити через конфігурацію, обравши отримання ціни через парсинг HTML-сторінки або через віддалені GraphQL виклики.

## Розгортання сервісу

Щоб запустити сервіс локально, виконайте наступні кроки:

1. Клонуванная репозиторія:
```bash
git clone <URL_репозиторію>
```
2. Заповнити файли конфігурації .env та .env.docker необхідними параметрами.
3. Збирання docker compose:
```bash
make build
```
4. Підняття docker compose:
```bash
make up
```
5. Міграції:
```bash
make migrate
```
6. Підняття Laravel Horizon:
```bash
make horizon
```
7. Підняття scheduler(для тесту розкоментувати код у console.php):
```bash
make schedule
```

## Особисті зауваження

1. Стратегія трекінгу ціни через GraphQL працює, але лише для оголошень з назвами англійською мовою. Іншого способу відслідковувати ціну всіх оголошень через GraphQL я не знайшов((.
2. Було б корисно додати Swagger API документацію, але через обмеження часу цього зроблено не було. Проте це було б must-have.
3. Не всі інтерфейси повністю відповідають 4 принципам SOLID, особливо ті, що стосуються репозиторіїв, через можливе подальше роздування інтерфейсного шару. На мою думку, у цьому контексті цим можна знехтувати.
4. У сервісі використовуються додаткові пакети: `spatie/laravel-data` для роботи з DTO та `symfony/dom-crawler` для HTML-парсингу.
5. З точки зору мікросервісної архітектури, для внутрішньої архітектури проекту краще підійшов би DDD або Clean Architecture, але у даному випадку я віддав перевагу чистому MVC, щоб не ускладнювати реалізацію.
